# from console when running "multiple models.R"

>   bg <- read_faa("data-raw/tmpdata/swissprot-all-april19.fasta")
>   bg$Label <- "Bg"
> #remove rows in bg that are in tg
> bg <- bg[!bg$seq.aa %in% tg$seq.aa,]
> tg <- remove_nonstandard_aa(tg, tg$seq.aa)
> bg <- remove_nonstandard_aa(bg, bg$seq.aa)
> set.seed(7)
> bg <- bg[sample(nrow(bg),3481),]
> bg_tg <- rbind(bg, tg)
> #calculate features (this can take some time depending on the dataset size)
> features <- calculate_features(bg_tg$seq.aa)
> features[["Label"]] <- factor(features[["Label"]])
Error in `[[<-.data.frame`(`*tmp*`, "Label", value = integer(0)) :
  replacement has 0 rows, data has 6962
> features$Label <- bg_tg$Label
> features[["Label"]] <- factor(features[["Label"]])
> set.seed(1)
> library(caret)
>
> set.seed(1)
>
> #split the data 80/20 and create train and test set from features
> #the model is fit on the training set, and the fitted model is used to predict the dependent variable (response or Y variable)
> trainIndex <-createDataPartition(y=features$Label, p=.8, list = FALSE)
> featuresTrain <-features[trainIndex,]
> featuresTest <-features[-trainIndex,]
>
> #resample method using repeated cross validation and adding in and adding in a probability calculation to use later when predicting
> trctrl_prob <- trainControl(method = "repeatedcv", number = 10, repeats = 3, classProbs = TRUE)
>
> set.seed(1)
> svm_Radial1 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.060606 -0.2564951 1.22256e-05 6.479386e-06 -3.64266e-08 -1.955415e-08 -5.72036e-13line search fails -2.068222 -0.2367047 1.158722e-05 6.125997e-06 -3.431847e-08 -1.809308e-08 -5.084937e-13Warning messages:
1: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
2: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
3: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
4: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
5: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
6: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
7: In nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,  :
  There were missing values in resampled performance measures.
>
> set.seed(2)
> svm_Radial2 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.058009 -0.2499662 1.130034e-05 6.055085e-06 -3.345316e-08 -1.804345e-08 -4.872868e-13Warning messages:
1: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
2: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
3: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
4: In nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,  :
  There were missing values in resampled performance measures.
>
> set.seed(3)
> svm_Radial3 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
>
> set.seed(4)
> svm_Radial4 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.063451 -0.2382179 1.145986e-05 5.844867e-06 -3.373831e-08 -1.73868e-08 -4.882597e-13line search fails -2.068931 -0.2323382 1.100258e-05 5.774947e-06 -3.255202e-08 -1.692547e-08 -4.559e-13line search fails -2.060672 -0.2363069 1.312003e-05 7.025923e-06 -3.880605e-08 -2.081047e-08 -6.553491e-13line search fails -2.053075 -0.2595613 1.035742e-05 5.648372e-06 -3.076643e-08 -1.68694e-08 -4.139454e-13There were 13 warnings (use warnings() to see them)
>
>
> set.seed(5)
> svm_Radial5 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.065348 -0.2394827 1.021657e-05 5.29314e-06 -3.029347e-08 -1.563062e-08 -3.922303e-13Warning messages:
1: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
2: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
3: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
4: In nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,  :
  There were missing values in resampled performance measures.
>
> set.seed(6)
> svm_Radial6 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.064194 -0.2112413 1.073485e-05 5.418238e-06 -3.137387e-08 -1.562872e-08 -4.21474e-13line search fails -2.058578 -0.2348065 1.004098e-05 5.28458e-06 -2.947742e-08 -1.547274e-08 -3.777492e-13Warning messages:
1: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
2: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
3: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
4: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
5: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
6: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
7: In nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,  :
  There were missing values in resampled performance measures.
>
> set.seed(7)
> svm_Radial7 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.049495 -0.2340038 1.001948e-05 5.363758e-06 -2.929923e-08 -1.563884e-08 -3.774461e-13Warning messages:
1: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
2: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
3: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
4: In nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,  :
  There were missing values in resampled performance measures.
>
> set.seed(8)
> svm_Radial8 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.079779 -0.2245037 1.136814e-05 5.791306e-06 -3.365819e-08 -1.697655e-08 -4.809475e-13line search fails -2.07164 -0.2280623 1.155648e-05 5.929743e-06 -3.406662e-08 -1.744095e-08 -4.971105e-13line search fails -2.088909 -0.2093192 1.237907e-05 6.085041e-06 -3.650078e-08 -1.767183e-08 -5.593796e-13Warning messages:
1: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
2: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
3: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
4: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
5: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
6: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
7: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
8: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
9: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
10: In nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,  :
  There were missing values in resampled performance measures.
> set.seed(9)
> svm_Radial9 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.075164 -0.2335175 1.237175e-05 6.269515e-06 -3.66182e-08 -1.862164e-08 -5.697799e-13line search fails -2.069254 -0.2322434 1.115681e-05 5.880879e-06 -3.288474e-08 -1.724842e-08 -4.683247e-13line search fails -2.075903 -0.2249789 1.021831e-05 5.119983e-06 -3.015375e-08 -1.496612e-08 -3.847466e-13line search fails -2.053064 -0.2284968 1.000632e-05 5.445733e-06 -2.917031e-08 -1.576886e-08 -3.777605e-13line search fails -2.072311 -0.2485028 1.021678e-05 5.444411e-06 -3.051574e-08 -1.618536e-08 -3.998923e-13There were 16 warnings (use warnings() to see them)
>
> set.seed(10)
> svm_Radial10 <- train(Label~., data = featuresTrain, method="svmRadial",
+                     trControl = trctrl_prob, preProcess = c("center", "scale"),
+                     tuneLength = 10)
line search fails -2.071269 -0.2476666 1.349658e-05 7.113274e-06 -4.071667e-08 -2.141128e-08 -7.0184e-13line search fails -2.061491 -0.2193338 1.031858e-05 5.414688e-06 -3.023137e-08 -1.561416e-08 -3.964906e-13Warning messages:
1: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
2: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
3: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
4: In method$predict(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class prediction calculations failed; returning NAs
5: In method$prob(modelFit = modelFit, newdata = newdata, submodels = param) :
  kernlab class probability calculations failed; returning NAs
6: In data.frame(..., check.names = FALSE) :
  row names were found from a short variable and have been discarded
7: In nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,  :
  There were missing values in resampled performance measures.
>
> test_pred1 <- predict(svm_Radial1, featuresTest)
> test_pred2 <- predict(svm_Radial2, featuresTest)
> test_pred3 <- predict(svm_Radial3, featuresTest)
> test_pred4 <- predict(svm_Radial4, featuresTest)
> test_pred5 <- predict(svm_Radial5, featuresTest)
> test_pred6 <- predict(svm_Radial6, featuresTest)
> test_pred7 <- predict(svm_Radial7, featuresTest)
> test_pred8 <- predict(svm_Radial8, featuresTest)
> test_pred9 <- predict(svm_Radial9, featuresTest)
> test_pred10 <- predict(svm_Radial10, featuresTest)
